<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Control | Ingeniería TI v2.0</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body>
    <!-- Header con información del usuario -->
    <div class="header">
        <div class="user-info">
            <div class="user-badge">
                <span class="status-indicator online"></span>
                {{ current_user.username }}
            </div>
            <span class="system-status">Sistema Operativo</span>
        </div>
        <div style="display: flex; gap: 12px; align-items: center;">
            {% if current_user.username == 'admin' %}
            <a href="{{ url_for('admin_panel') }}" class="btn-admin">Panel Admin</a>
            {% endif %}
            <a href="{{ url_for('logout') }}" class="btn-logout">Cerrar Sesión</a>
        </div>
    </div>
    
    <!-- Dashboard Principal -->
    <div class="dashboard">
        <h1>Sistema de <span class="accent">Control Distribuido</span></h1>
        
        <!-- KPIs del Sistema -->
        <div class="monitor">
            <div class="kpi" id="kpi-estado">
                <h2 id="modo-val">STANDBY</h2>
                <span>Estado Actual</span>
            </div>
            <div class="kpi">
                <h2 id="cpu-val">0%</h2>
                <span>Carga CPU</span>
            </div>
            <div class="kpi">
                <h2 id="latencia-val">0ms</h2>
                <span>Latencia</span>
            </div>
        </div>

        <!-- Botones de Control -->
        <div class="botones">
            <button class="btn-voz" onclick="enviarComando('CONFERENCIA', this)">
                Modo Conferencia
            </button>
            <button class="btn-cine" onclick="enviarComando('CINE', this)">
                Modo Cine
            </button>
            <button class="btn-off" onclick="confirmarApagado(this)">
                Apagar Sistema
            </button>
        </div>

        <!-- Consola de Logs -->
        <h3 style="margin: 28px 0 12px 0; color: var(--text-secondary); font-size: 0.875rem; font-weight: 600; text-transform: uppercase;">
            Registro de Eventos
        </h3>
        <div class="consola" id="log-box">
            <div class="log-row INFO">Cargando eventos...</div>
        </div>
    </div>
    
    <!-- Modal de Confirmación -->
    <div id="modal-confirm" class="modal">
        <div class="modal-content">
            <h2>Confirmación requerida</h2>
            <p>¿Está seguro que desea apagar el sistema?</p>
            <p style="font-size: 0.875rem; margin-top: 8px;">
                Esta acción detendrá todos los servicios activos.
            </p>
            <div class="modal-buttons">
                <button class="btn-cancel" onclick="cerrarModal()">
                    Cancelar
                </button>
                <button class="btn-confirm" onclick="confirmarApagadoFinal()">
                    Confirmar Apagado
                </button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>